-- Sample schema and data for tutorials.
-- Designed for filters, sorting, and unique lookups.

CREATE DATABASE IF NOT EXISTS tidb_graphql_tutorial;
USE tidb_graphql_tutorial;

DROP TABLE IF EXISTS order_items;
DROP TABLE IF EXISTS product_categories;
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS products;
DROP TABLE IF EXISTS categories;
DROP TABLE IF EXISTS users;

CREATE TABLE users (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  email VARCHAR(255) NOT NULL,
  email_domain VARCHAR(255) AS (SUBSTRING_INDEX(email, '@', -1)) VIRTUAL,
  full_name VARCHAR(255) NOT NULL,
  status VARCHAR(32) NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  last_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uq_users_email (email),
  KEY idx_users_status (status),
  KEY idx_users_created_at (created_at)
);

CREATE TABLE categories (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(64) NOT NULL,
  description VARCHAR(255) NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  last_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uq_categories_name (name),
  KEY idx_categories_created_at (created_at)
);

CREATE TABLE products (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  sku VARCHAR(64) NOT NULL,
  name VARCHAR(255) NOT NULL,
  price_cents INT NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  last_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  UNIQUE KEY uq_products_sku (sku),
  KEY idx_products_price (price_cents)
);

CREATE TABLE product_categories (
  product_id BIGINT NOT NULL,
  category_id BIGINT NOT NULL,
  PRIMARY KEY (product_id, category_id),
  CONSTRAINT fk_product_categories_product
    FOREIGN KEY (product_id) REFERENCES products(id),
  CONSTRAINT fk_product_categories_category
    FOREIGN KEY (category_id) REFERENCES categories(id),
  KEY idx_product_categories_category (category_id)
);

CREATE TABLE orders (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  user_id BIGINT NOT NULL,
  status VARCHAR(32) NOT NULL,
  total_cents INT NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  last_updated TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  CONSTRAINT fk_orders_user
    FOREIGN KEY (user_id) REFERENCES users(id),
  KEY idx_orders_user_id (user_id),
  KEY idx_orders_status (status),
  KEY idx_orders_created_at (created_at)
);

CREATE TABLE order_items (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  order_id BIGINT NOT NULL,
  product_id BIGINT NOT NULL,
  quantity INT NOT NULL,
  unit_price_cents INT NOT NULL,
  CONSTRAINT fk_order_items_order
    FOREIGN KEY (order_id) REFERENCES orders(id),
  CONSTRAINT fk_order_items_product
    FOREIGN KEY (product_id) REFERENCES products(id),
  KEY idx_items_order_id (order_id),
  KEY idx_items_product_id (product_id)
);

INSERT INTO users (email, full_name, status) VALUES
  ('ava.lee@example.com', 'Ava Lee', 'active'),
  ('ava.turner@example.com', 'Ava Turner', 'active'),
  ('ava.park@example.com', 'Ava Park', 'inactive'),
  ('ava.ng@example.com', 'Ava Ng', 'pending'),
  ('ava.jones@example.com', 'Ava Jones', 'active'),
  ('ben.lee@example.com', 'Ben Lee', 'active'),
  ('ben.turner@example.com', 'Ben Turner', 'inactive'),
  ('ben.park@example.com', 'Ben Park', 'pending'),
  ('ben.ng@example.com', 'Ben Ng', 'active'),
  ('ben.jones@example.com', 'Ben Jones', 'active'),
  ('chloe.lee@example.com', 'Chloe Lee', 'inactive'),
  ('chloe.turner@example.com', 'Chloe Turner', 'pending'),
  ('chloe.park@example.com', 'Chloe Park', 'active'),
  ('chloe.ng@example.com', 'Chloe Ng', 'active'),
  ('chloe.jones@example.com', 'Chloe Jones', 'inactive'),
  ('drew.lee@example.com', 'Drew Lee', 'pending'),
  ('drew.turner@example.com', 'Drew Turner', 'active'),
  ('drew.park@example.com', 'Drew Park', 'active'),
  ('drew.ng@example.com', 'Drew Ng', 'inactive'),
  ('drew.jones@example.com', 'Drew Jones', 'pending'),
  ('eli.lee@example.com', 'Eli Lee', 'active'),
  ('eli.turner@example.com', 'Eli Turner', 'active'),
  ('eli.park@example.com', 'Eli Park', 'inactive'),
  ('eli.ng@example.com', 'Eli Ng', 'pending'),
  ('eli.jones@example.com', 'Eli Jones', 'active'),
  ('finn.lee@example.com', 'Finn Lee', 'active'),
  ('finn.turner@example.com', 'Finn Turner', 'inactive'),
  ('finn.park@example.com', 'Finn Park', 'pending'),
  ('finn.ng@example.com', 'Finn Ng', 'active'),
  ('finn.jones@example.com', 'Finn Jones', 'active'),
  ('gia.lee@example.com', 'Gia Lee', 'inactive'),
  ('gia.turner@example.com', 'Gia Turner', 'pending'),
  ('gia.park@example.com', 'Gia Park', 'active'),
  ('gia.ng@example.com', 'Gia Ng', 'active'),
  ('gia.jones@example.com', 'Gia Jones', 'inactive'),
  ('hana.lee@example.com', 'Hana Lee', 'pending'),
  ('hana.turner@example.com', 'Hana Turner', 'active'),
  ('hana.park@example.com', 'Hana Park', 'active'),
  ('hana.ng@example.com', 'Hana Ng', 'inactive'),
  ('hana.jones@example.com', 'Hana Jones', 'pending'),
  ('ian.lee@example.com', 'Ian Lee', 'active'),
  ('ian.turner@example.com', 'Ian Turner', 'active'),
  ('ian.park@example.com', 'Ian Park', 'inactive'),
  ('ian.ng@example.com', 'Ian Ng', 'pending'),
  ('ian.jones@example.com', 'Ian Jones', 'active'),
  ('jules.lee@example.com', 'Jules Lee', 'active'),
  ('jules.turner@example.com', 'Jules Turner', 'inactive'),
  ('jules.park@example.com', 'Jules Park', 'pending'),
  ('jules.ng@example.com', 'Jules Ng', 'active'),
  ('jules.jones@example.com', 'Jules Jones', 'active');

INSERT INTO categories (name, description) VALUES
  ('stationery', 'Paper goods, notebooks, and desk accessories'),
  ('kitchen', 'Drinkware and kitchen essentials'),
  ('office', 'Workspace gear and desk setup'),
  ('electronics', 'Devices, peripherals, and power'),
  ('outdoor', 'Travel and outdoor-ready items'),
  ('wellness', 'Comfort and wellbeing gear');

INSERT INTO products (sku, name, price_cents) VALUES
  ('SKU-1001', 'Graphite Notebook', 1200),
  ('SKU-1002', 'Ceramic Mug', 1800),
  ('SKU-1003', 'Desk Lamp', 4900),
  ('SKU-1004', 'Wireless Mouse', 3500),
  ('SKU-1005', 'Insulated Bottle', 2600),
  ('SKU-1006', 'Mechanical Keyboard', 8900),
  ('SKU-1007', 'Noise-canceling Headphones', 15900),
  ('SKU-1008', 'Standing Desk Mat', 4200),
  ('SKU-1009', 'Gel Pen Set', 900),
  ('SKU-1010', 'Smart Thermos', 5200),
  ('SKU-1011', 'Portable Charger', 3400),
  ('SKU-1012', 'Canvas Tote', 1500),
  ('SKU-1013', 'LED Monitor', 19900),
  ('SKU-1014', 'Stainless Cutlery Set', 2400),
  ('SKU-1015', 'Yoga Mat', 3200),
  ('SKU-1016', 'Travel Organizer', 2800),
  ('SKU-1017', 'Minimalist Backpack', 7200),
  ('SKU-1018', 'Bluetooth Speaker', 6800),
  ('SKU-1019', 'Whiteboard', 2700),
  ('SKU-1020', 'Water-resistant Notebook', 1600);

INSERT INTO product_categories (product_id, category_id) VALUES
  (1, 1),
  (1, 3),
  (2, 2),
  (2, 3),
  (3, 3),
  (3, 4),
  (4, 3),
  (4, 4),
  (5, 2),
  (5, 5),
  (5, 6),
  (6, 3),
  (6, 4),
  (7, 3),
  (7, 4),
  (8, 3),
  (8, 6),
  (9, 1),
  (9, 3),
  (10, 2),
  (10, 4),
  (10, 5),
  (11, 4),
  (11, 5),
  (12, 3),
  (12, 5),
  (13, 3),
  (13, 4),
  (14, 2),
  (15, 5),
  (15, 6),
  (16, 3),
  (16, 5),
  (17, 3),
  (17, 5),
  (18, 4),
  (18, 5),
  (19, 1),
  (19, 3),
  (20, 1),
  (20, 5);

INSERT INTO orders (user_id, status, total_cents) VALUES
  (1, 'paid', 18300),
  (2, 'shipped', 23400),
  (3, 'processing', 3500),
  (4, 'canceled', 31900),
  (5, 'paid', 51000),
  (6, 'shipped', 15900),
  (7, 'processing', 11100),
  (8, 'canceled', 14700),
  (9, 'paid', 5200),
  (10, 'shipped', 11300),
  (11, 'processing', 29200),
  (12, 'canceled', 19900),
  (13, 'paid', 14400),
  (14, 'shipped', 26800),
  (15, 'processing', 2800),
  (16, 'canceled', 34800),
  (17, 'paid', 26300),
  (18, 'shipped', 2700),
  (19, 'processing', 6800),
  (20, 'canceled', 15200),
  (21, 'paid', 1800),
  (22, 'shipped', 20300),
  (23, 'processing', 30900),
  (24, 'canceled', 2600),
  (25, 'paid', 65500),
  (26, 'shipped', 53700),
  (27, 'processing', 4200),
  (28, 'canceled', 17400),
  (29, 'paid', 22000),
  (30, 'shipped', 3400),
  (31, 'processing', 62700),
  (32, 'canceled', 68500),
  (33, 'paid', 2400),
  (34, 'shipped', 14800),
  (35, 'processing', 29200),
  (36, 'canceled', 7200),
  (37, 'paid', 21700),
  (38, 'shipped', 12100),
  (39, 'processing', 1600),
  (40, 'canceled', 7800),
  (41, 'paid', 17300),
  (42, 'shipped', 4900),
  (43, 'processing', 14800),
  (44, 'canceled', 48500),
  (45, 'paid', 8900),
  (46, 'shipped', 44400),
  (47, 'processing', 23900),
  (48, 'canceled', 900),
  (49, 'paid', 20600),
  (50, 'shipped', 51500),
  (1, 'processing', 1500),
  (2, 'canceled', 47000),
  (3, 'paid', 16000),
  (4, 'shipped', 3200),
  (5, 'processing', 27200),
  (6, 'canceled', 33800),
  (7, 'paid', 6800),
  (8, 'shipped', 10200),
  (9, 'processing', 9600),
  (10, 'canceled', 1200),
  (11, 'paid', 18300),
  (12, 'shipped', 23400),
  (13, 'processing', 3500),
  (14, 'canceled', 31900),
  (15, 'paid', 51000),
  (16, 'shipped', 15900),
  (17, 'processing', 11100),
  (18, 'canceled', 14700),
  (19, 'paid', 5200),
  (20, 'shipped', 11300),
  (21, 'processing', 29200),
  (22, 'canceled', 19900),
  (23, 'paid', 14400),
  (24, 'shipped', 26800),
  (25, 'processing', 2800),
  (26, 'canceled', 34800),
  (27, 'paid', 26300),
  (28, 'shipped', 2700),
  (29, 'processing', 6800),
  (30, 'canceled', 15200),
  (31, 'paid', 1800),
  (32, 'shipped', 20300),
  (33, 'processing', 30900),
  (34, 'canceled', 2600),
  (35, 'paid', 65500),
  (36, 'shipped', 53700),
  (37, 'processing', 4200),
  (38, 'canceled', 17400),
  (39, 'paid', 22000),
  (40, 'shipped', 3400),
  (41, 'processing', 62700),
  (42, 'canceled', 68500),
  (43, 'paid', 2400),
  (44, 'shipped', 14800),
  (45, 'processing', 29200),
  (46, 'canceled', 7200),
  (47, 'paid', 21700),
  (48, 'shipped', 12100),
  (49, 'processing', 1600),
  (50, 'canceled', 7800);

INSERT INTO order_items (order_id, product_id, quantity, unit_price_cents) VALUES
  (1, 2, 2, 1800),
  (1, 3, 3, 4900),
  (2, 3, 3, 4900),
  (2, 4, 1, 3500),
  (2, 5, 2, 2600),
  (3, 4, 1, 3500),
  (4, 5, 2, 2600),
  (4, 6, 3, 8900),
  (5, 6, 3, 8900),
  (5, 7, 1, 15900),
  (5, 8, 2, 4200),
  (6, 7, 1, 15900),
  (7, 8, 2, 4200),
  (7, 9, 3, 900),
  (8, 9, 3, 900),
  (8, 10, 1, 5200),
  (8, 11, 2, 3400),
  (9, 10, 1, 5200),
  (10, 11, 2, 3400),
  (10, 12, 3, 1500),
  (11, 12, 3, 1500),
  (11, 13, 1, 19900),
  (11, 14, 2, 2400),
  (12, 13, 1, 19900),
  (13, 14, 2, 2400),
  (13, 15, 3, 3200),
  (14, 15, 3, 3200),
  (14, 16, 1, 2800),
  (14, 17, 2, 7200),
  (15, 16, 1, 2800),
  (16, 17, 2, 7200),
  (16, 18, 3, 6800),
  (17, 18, 3, 6800),
  (17, 19, 1, 2700),
  (17, 20, 2, 1600),
  (18, 19, 1, 2700),
  (19, 20, 2, 1600),
  (19, 1, 3, 1200),
  (20, 1, 3, 1200),
  (20, 2, 1, 1800),
  (20, 3, 2, 4900),
  (21, 2, 1, 1800),
  (22, 3, 2, 4900),
  (22, 4, 3, 3500),
  (23, 4, 3, 3500),
  (23, 5, 1, 2600),
  (23, 6, 2, 8900),
  (24, 5, 1, 2600),
  (25, 6, 2, 8900),
  (25, 7, 3, 15900),
  (26, 7, 3, 15900),
  (26, 8, 1, 4200),
  (26, 9, 2, 900),
  (27, 8, 1, 4200),
  (28, 9, 2, 900),
  (28, 10, 3, 5200),
  (29, 10, 3, 5200),
  (29, 11, 1, 3400),
  (29, 12, 2, 1500),
  (30, 11, 1, 3400),
  (31, 12, 2, 1500),
  (31, 13, 3, 19900),
  (32, 13, 3, 19900),
  (32, 14, 1, 2400),
  (32, 15, 2, 3200),
  (33, 14, 1, 2400),
  (34, 15, 2, 3200),
  (34, 16, 3, 2800),
  (35, 16, 3, 2800),
  (35, 17, 1, 7200),
  (35, 18, 2, 6800),
  (36, 17, 1, 7200),
  (37, 18, 2, 6800),
  (37, 19, 3, 2700),
  (38, 19, 3, 2700),
  (38, 20, 1, 1600),
  (38, 1, 2, 1200),
  (39, 20, 1, 1600),
  (40, 1, 2, 1200),
  (40, 2, 3, 1800),
  (41, 2, 3, 1800),
  (41, 3, 1, 4900),
  (41, 4, 2, 3500),
  (42, 3, 1, 4900),
  (43, 4, 2, 3500),
  (43, 5, 3, 2600),
  (44, 5, 3, 2600),
  (44, 6, 1, 8900),
  (44, 7, 2, 15900),
  (45, 6, 1, 8900),
  (46, 7, 2, 15900),
  (46, 8, 3, 4200),
  (47, 8, 3, 4200),
  (47, 9, 1, 900),
  (47, 10, 2, 5200),
  (48, 9, 1, 900),
  (49, 10, 2, 5200),
  (49, 11, 3, 3400),
  (50, 11, 3, 3400),
  (50, 12, 1, 1500),
  (50, 13, 2, 19900),
  (51, 12, 1, 1500),
  (52, 13, 2, 19900),
  (52, 14, 3, 2400),
  (53, 14, 3, 2400),
  (53, 15, 1, 3200),
  (53, 16, 2, 2800),
  (54, 15, 1, 3200),
  (55, 16, 2, 2800),
  (55, 17, 3, 7200),
  (56, 17, 3, 7200),
  (56, 18, 1, 6800),
  (56, 19, 2, 2700),
  (57, 18, 1, 6800),
  (58, 19, 2, 2700),
  (58, 20, 3, 1600),
  (59, 20, 3, 1600),
  (59, 1, 1, 1200),
  (59, 2, 2, 1800),
  (60, 1, 1, 1200),
  (61, 2, 2, 1800),
  (61, 3, 3, 4900),
  (62, 3, 3, 4900),
  (62, 4, 1, 3500),
  (62, 5, 2, 2600),
  (63, 4, 1, 3500),
  (64, 5, 2, 2600),
  (64, 6, 3, 8900),
  (65, 6, 3, 8900),
  (65, 7, 1, 15900),
  (65, 8, 2, 4200),
  (66, 7, 1, 15900),
  (67, 8, 2, 4200),
  (67, 9, 3, 900),
  (68, 9, 3, 900),
  (68, 10, 1, 5200),
  (68, 11, 2, 3400),
  (69, 10, 1, 5200),
  (70, 11, 2, 3400),
  (70, 12, 3, 1500),
  (71, 12, 3, 1500),
  (71, 13, 1, 19900),
  (71, 14, 2, 2400),
  (72, 13, 1, 19900),
  (73, 14, 2, 2400),
  (73, 15, 3, 3200),
  (74, 15, 3, 3200),
  (74, 16, 1, 2800),
  (74, 17, 2, 7200),
  (75, 16, 1, 2800),
  (76, 17, 2, 7200),
  (76, 18, 3, 6800),
  (77, 18, 3, 6800),
  (77, 19, 1, 2700),
  (77, 20, 2, 1600),
  (78, 19, 1, 2700),
  (79, 20, 2, 1600),
  (79, 1, 3, 1200),
  (80, 1, 3, 1200),
  (80, 2, 1, 1800),
  (80, 3, 2, 4900),
  (81, 2, 1, 1800),
  (82, 3, 2, 4900),
  (82, 4, 3, 3500),
  (83, 4, 3, 3500),
  (83, 5, 1, 2600),
  (83, 6, 2, 8900),
  (84, 5, 1, 2600),
  (85, 6, 2, 8900),
  (85, 7, 3, 15900),
  (86, 7, 3, 15900),
  (86, 8, 1, 4200),
  (86, 9, 2, 900),
  (87, 8, 1, 4200),
  (88, 9, 2, 900),
  (88, 10, 3, 5200),
  (89, 10, 3, 5200),
  (89, 11, 1, 3400),
  (89, 12, 2, 1500),
  (90, 11, 1, 3400),
  (91, 12, 2, 1500),
  (91, 13, 3, 19900),
  (92, 13, 3, 19900),
  (92, 14, 1, 2400),
  (92, 15, 2, 3200),
  (93, 14, 1, 2400),
  (94, 15, 2, 3200),
  (94, 16, 3, 2800),
  (95, 16, 3, 2800),
  (95, 17, 1, 7200),
  (95, 18, 2, 6800),
  (96, 17, 1, 7200),
  (97, 18, 2, 6800),
  (97, 19, 3, 2700),
  (98, 19, 3, 2700),
  (98, 20, 1, 1600),
  (98, 1, 2, 1200),
  (99, 20, 1, 1600),
  (100, 1, 2, 1200),
  (100, 2, 3, 1800);
